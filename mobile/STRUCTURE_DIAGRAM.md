# ğŸ“ Unified App Structure - Visual Diagram

## ğŸ—ï¸ Complete Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MOBILE APP (Single App)                      â”‚
â”‚                    mobile/                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     app/_layout.tsx (Root)         â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  AuthProvider                 â”‚  â”‚
        â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
        â”‚  â”‚  â”‚  OrderProvider         â”‚   â”‚  â”‚
        â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”‚
        â”‚  â”‚  â”‚  â”‚  Stack Navigator â”‚  â”‚   â”‚  â”‚
        â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â”‚
        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   (auth)/     â”‚    â”‚  (customer)/  â”‚    â”‚   (staff)/    â”‚
â”‚               â”‚    â”‚               â”‚    â”‚               â”‚
â”‚  - login      â”‚    â”‚  - index      â”‚    â”‚  - index      â”‚
â”‚  - signup     â”‚    â”‚  - orders     â”‚    â”‚  - ongoing    â”‚
â”‚               â”‚    â”‚  - profile    â”‚    â”‚  - profile    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   (admin)/    â”‚
                    â”‚               â”‚
                    â”‚  - index      â”‚
                    â”‚  - orders     â”‚
                    â”‚  - staff      â”‚
                    â”‚  - inventory  â”‚
                    â”‚  - payments   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Authentication Flow (Detailed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER OPENS APP                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   AuthContext.checkAuth()     â”‚
            â”‚   - Check AsyncStorage        â”‚
            â”‚   - Look for token & user     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                               â”‚
            â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  No Token     â”‚              â”‚  Has Token   â”‚
    â”‚  No User      â”‚              â”‚  Has User    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                               â”‚
            â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Show Login   â”‚              â”‚  Check Role  â”‚
    â”‚  (auth)/login â”‚              â”‚  & Navigate  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                               â”‚
            â”‚                               â”œâ”€â”€â”€ customer â†’ (customer)/
            â”‚                               â”œâ”€â”€â”€ staff    â†’ (staff)/
            â”‚                               â””â”€â”€â”€ admin   â†’ (admin)/
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User Logs In  â”‚
    â”‚ (email/phone  â”‚
    â”‚  + password)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  POST /api/auth/login         â”‚
    â”‚  { email/phone, password }    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Response:                    â”‚
    â”‚  {                            â”‚
    â”‚    token: "jwt_token",        â”‚
    â”‚    user: {                    â”‚
    â”‚      id: "...",               â”‚
    â”‚      email: "...",            â”‚
    â”‚      phone: "...",            â”‚
    â”‚      role: "customer|staff|admin" â”‚
    â”‚    }                          â”‚
    â”‚  }                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AuthContext:                 â”‚
    â”‚  - storage.setToken(token)     â”‚
    â”‚  - storage.setUser(user)       â”‚
    â”‚  - setUser(user)              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  useEffect detects user changeâ”‚
    â”‚  navigateToRoleScreen(role)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚
        â–¼           â–¼           â–¼
    customer    staff      admin
        â”‚           â”‚           â”‚
        â–¼           â–¼           â–¼
  (customer)/  (staff)/   (admin)/
```

## ğŸ“± Screen Navigation Map

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   App Root   â”‚
                    â”‚  _layout.tsx â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
        â–¼                  â–¼                  â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ (auth)  â”‚       â”‚(customer)â”‚      â”‚ (staff)  â”‚
   â”‚         â”‚       â”‚          â”‚      â”‚          â”‚
   â”‚ login   â”‚       â”‚  Home    â”‚      â”‚  New     â”‚
   â”‚ signup  â”‚       â”‚  Orders  â”‚      â”‚  Orders  â”‚
   â”‚         â”‚       â”‚  Profile â”‚      â”‚  Ongoing â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  Profile â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       â”‚ (admin)  â”‚
                                       â”‚          â”‚
                                       â”‚ Dashboardâ”‚
                                       â”‚  Orders  â”‚
                                       â”‚  Staff   â”‚
                                       â”‚ Inventoryâ”‚
                                       â”‚ Payments â”‚
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Role-Based Access

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER LOGS IN                             â”‚
â”‚              Gets: { role: "customer" }                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  AuthContext.navigateToRole() â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CUSTOMER    â”‚   â”‚    STAFF     â”‚   â”‚    ADMIN     â”‚
â”‚               â”‚   â”‚               â”‚   â”‚               â”‚
â”‚ Sees Only:    â”‚   â”‚ Sees Only:   â”‚   â”‚ Sees Only:   â”‚
â”‚ - Home        â”‚   â”‚ - New Orders â”‚   â”‚ - Dashboard  â”‚
â”‚ - Orders      â”‚   â”‚ - Ongoing    â”‚   â”‚ - Orders     â”‚
â”‚ - Profile     â”‚   â”‚ - Profile    â”‚   â”‚ - Staff      â”‚
â”‚               â”‚   â”‚               â”‚   â”‚ - Inventory â”‚
â”‚ Cannot Access:â”‚   â”‚ Cannot Access:â”‚   â”‚ - Payments  â”‚
â”‚ - Staff tabs  â”‚   â”‚ - Customer   â”‚   â”‚               â”‚
â”‚ - Admin tabs  â”‚   â”‚ - Admin tabs â”‚   â”‚ Cannot Access:â”‚
â”‚               â”‚   â”‚               â”‚   â”‚ - Customer  â”‚
â”‚               â”‚   â”‚               â”‚   â”‚ - Staff tabsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ File Organization

```
mobile/
â”‚
â”œâ”€â”€ app/                          # Expo Router screens
â”‚   â”œâ”€â”€ _layout.tsx              # Root (AuthProvider wrapper)
â”‚   â”‚
â”‚   â”œâ”€â”€ (auth)/                  # Authentication group
â”‚   â”‚   â”œâ”€â”€ _layout.tsx         # Auth stack
â”‚   â”‚   â”œâ”€â”€ login.tsx           # Login (all roles)
â”‚   â”‚   â””â”€â”€ signup.tsx          # Signup (role picker)
â”‚   â”‚
â”‚   â”œâ”€â”€ (customer)/              # Customer screens
â”‚   â”‚   â”œâ”€â”€ _layout.tsx         # Customer tabs
â”‚   â”‚   â”œâ”€â”€ index.tsx           # Home
â”‚   â”‚   â”œâ”€â”€ orders.tsx          # Orders list
â”‚   â”‚   â”œâ”€â”€ order-details/       # Order details
â”‚   â”‚   â””â”€â”€ profile.tsx         # Profile
â”‚   â”‚
â”‚   â”œâ”€â”€ (staff)/                 # Staff screens
â”‚   â”‚   â”œâ”€â”€ _layout.tsx         # Staff tabs
â”‚   â”‚   â”œâ”€â”€ index.tsx           # New orders
â”‚   â”‚   â”œâ”€â”€ ongoing.tsx         # Ongoing orders
â”‚   â”‚   â””â”€â”€ profile.tsx         # Profile
â”‚   â”‚
â”‚   â””â”€â”€ (admin)/                 # Admin screens
â”‚       â”œâ”€â”€ _layout.tsx         # Admin tabs
â”‚       â”œâ”€â”€ index.tsx           # Dashboard
â”‚       â”œâ”€â”€ orders.tsx          # All orders
â”‚       â”œâ”€â”€ staff.tsx           # Staff mgmt
â”‚       â”œâ”€â”€ inventory.tsx       # Inventory
â”‚       â””â”€â”€ payments.tsx        # Payments
â”‚
â””â”€â”€ src/                          # Source code
    â”œâ”€â”€ context/                  # React contexts
    â”‚   â”œâ”€â”€ AuthContext.tsx     # âœ… Unified auth
    â”‚   â””â”€â”€ OrderContext.tsx    # â³ Order state
    â”‚
    â”œâ”€â”€ services/                 # API services
    â”‚   â”œâ”€â”€ api.ts              # âœ… Axios client
    â”‚   â”œâ”€â”€ auth.service.ts     # âœ… Auth API
    â”‚   â”œâ”€â”€ order.service.ts    # â³ Order API
    â”‚   â”œâ”€â”€ staff.service.ts    # â³ Staff API
    â”‚   â”œâ”€â”€ admin.service.ts    # â³ Admin API
    â”‚   â””â”€â”€ socket.service.ts   # â³ Socket.io
    â”‚
    â”œâ”€â”€ components/               # UI components
    â”‚   â””â”€â”€ ui/                  # â³ Reusable components
    â”‚
    â”œâ”€â”€ types/                    # TypeScript types
    â”‚   â”œâ”€â”€ user.types.ts       # âœ… User types
    â”‚   â””â”€â”€ order.types.ts      # â³ Order types
    â”‚
    â””â”€â”€ utils/                    # Utilities
        â”œâ”€â”€ constants.ts         # âœ… Constants
        â””â”€â”€ storage.ts           # âœ… AsyncStorage
```

## âœ… Current Status

### Created & Ready:
- âœ… Root layout with providers
- âœ… Authentication screens (login, signup)
- âœ… Unified AuthContext with auto-navigation
- âœ… Auth service
- âœ… API client
- âœ… Storage utilities
- âœ… User types
- âœ… Config files (package.json, app.json, tsconfig.json)

### Needs to be Created:
- â³ Customer screens (4 screens)
- â³ Staff screens (3 screens)
- â³ Admin screens (5 screens)
- â³ OrderContext
- â³ Order service
- â³ Staff service
- â³ Admin service
- â³ Socket service
- â³ UI components
- â³ Order types

---

**Ready for review!** ğŸ‰




